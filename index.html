<!--
  This is a demonstrator of the ShExC hilighjs module.

  Airplane mode:
    By default, this doc fetches CSS and JS from unpkg.com in three places. Each
    can be swapped to read from the local filesystem. Checking out the git repo
    will provide this document and the three required resources.
 -->
<html>
  <head>
    <title>highlightjs-shexc user</title>
    <!-- <link rel="stylesheet" href="https://unpkg.com/highlightjs-shexc@0/style/shexc.css"/> -->
    <!-- <link rel="stylesheet" href="style/shexc.css"/> -->
    <link rel="stylesheet" href="../../build/cdn/styles/default.min.css"/>
    <style>
      #demos { display: flex; flex-flow: row wrap; }
      #demos > div { margin: .2em; border: thick solid #eee; display: flex; flex-flow: row wrap; align-items: top; }

#demos > div > pre  { flex: 1 100%; }
#demos > div > h2 { flex: 1; }
#demos > div > ul    { flex: 2; display999: none; }
    </style>
  </head>
  <body>
    <h1>highlightjs-shexc user</h1>
    <p>
      This is an example highlightjs-rdf document.
      It contains examples of Turtle, SPARQL, Trig, and multiple entry points to ShEx.
    </p>
    <div id="demos">
    <div>
    <h2>ShEx</h2>
    <ul></ul>
    <pre><code>
PREFIX : &lt;http://my.example/schema&gt;
PREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;
IMPORT &lt;../foo.shex&gt;
BASE &lt;http://my.example/schema&gt;

/* asdf
 */
&lt;IssueShape&gt; {
  :reproducedBy @&lt;EmployeeShape&gt;? ;
  :mode ["a\r\n" 1 :ab &apos;b&apos; 1.1 &lt;cd#ef&gt;~ - &lt;cd#efg&gt;~
         """c""" .1 &apos;&apos;&apos;d&apos;&apos;&apos; 1E1 "e&apos;" 1.1e1 &apos;f"&apos; .1e1 """
g
h"""]
}

ABSTRACT &lt;PersonShape&gt; {
  :name xsd:string ;
  :mbox IRI
}

&lt;UserShape&gt; EXTENDS @&lt;PersonShape&gt; {
  :representative @&lt;EmployeeShape&gt;
}

ABSTRACT &lt;RepShape&gt; {
  :phone IRI /^tel:\+?[1-9][0-9]{1,14}$/+ # E.164 number
}

&lt;EmployeeShape&gt;
  EXTENDS @&lt;PersonShape&gt; EXTENDS @&lt;RepShape&gt; {
}
    </code></pre>
    </div>
    <div>
    <h2>Trig</h2>
    <ul></ul>
    <pre><code class="trig">
&lt;IssueGraph1&gt; {
  &lt;Issue1&gt; :reproducedBy &lt;Employee2&gt;
}

    </code></pre>
    </div>
    <div>
    <h2>ShEx<br/>tripleExpressions</h2>
    <ul></ul>
    <pre><code class="language-texpr">
:name xsd:string ;
:mbox IRI ;
:contact @&lt;EmployeeShape&gt;
    </code></pre>
    </div>
    <div>
    <h2>Some SPARQL</h2>
    <ul></ul>
    <pre><code class="sparql">
#TEST of SPARQL syntax highlighting comment

PREFIX data: &lt;http://example.com/foaf/&gt;
PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;

prefix:relatedTo :Thing
prefix:relatedTo [ a :Thing];

SELECT ?mbox ?nick ?ppd
FROM NAMED &lt;http://example.org/foaf/aliceFoaf&gt;
FROM NAMED &lt;http://example.org/foaf/bobFoaf&gt;
WHERE
{
  GRAPH data:aliceFoaf
  {
    ?alice  foaf:mbox &lt;mailto:alice@work.example&gt;;
            foaf:knows ?whom .
    ?whom   foaf:mbox ?mbox ;
            rdfs:seeAlso ?ppd .
    ?ppd    a foaf:PersonaProfileDocument .
  } .
  GRAPH ?ppd
  {
    ?w  foaf:mbox ?mbox ;
        foaf:nick ?nick
  }
}

SELECT ?test
FROM NAMED &lt;http://something.com/rdf/thing&gt;;

&apos;&apos;&apos;The librarian said, "Perhaps you would
enjoy &apos;War and Peace&apos;."&apos;&apos;&apos;
&apos;chat&apos;@fr
1.0e6
true
false
"1.300"^^xsd:decimal

SELECT ?P (COUNT(?O) AS ?C)
WHERE { ?S ?P ?O }
GROUP BY ?P
HAVING (COUNT(?O) &gt; 2 )
    </code></pre>
    </div>
    <div>
    <h2>Turtle</h2>
    <ul></ul>
    <pre><code class="ttl">
@base &lt;http://example.org/&gt; .
@prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt; .
@prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt; .
@prefix rel: &lt;http://www.perceive.net/schemas/relationship/&gt; .

&lt;#green-goblin&gt;
    rel:enemyOf &lt;#spiderman&gt; ;
    a foaf:Person ;    # in the context of the Marvel universe
    foaf:name "Green Goblin" .

&lt;#spiderman&gt;
    rel:enemyOf &lt;#green-goblin&gt; ;
    a foaf:Person ;
    foaf:name "Spiderman", "Человек-паук"@ru .

 foaf:mbox  &lt;mailto:alice@example.org&gt;
    </code></pre>
    </div>
    </div>
    <!-- <script src="https://www.w3.org/2019/12/highlight.js"></script> -->
    <!-- <script src="https://raw.githubusercontent.com/yyyc514/highlight.js/squash_build_pipeline/src/highlight.js"></script> -->
    <script src="../../src/highlight.js"></script>
    <!-- <script src="https://unpkg.com/highlightjs-shexc@0/dist/shexc.min.js"></script> -->
    <script src="dist/shexc.min.js"></script>
    <!-- <script src="dist/wrapper.js"></script> -->
    <!-- <script src="https://unpkg.com/highlightjs-shexc@0/dist/sparql.min.js"></script> -->
    <script src="dist/ttl.min.js"></script>
    <script src="dist/sparql.min.js"></script>
    <script>
      // If you want to start from a nested production, e.g. "tripleExpression",
      // register it like so:
      hljs.registerLanguage('texpr', h =>
                            h.requireLanguage("shexc")
                            .rawDefinition({startingProduction: "tripleExpression"}));
      const guessLanguage = true;
      if (!guessLanguage)  {
        // Start syntax highlighting.
        hljs.initHighlightingOnLoad();
      } else {
        // Demonstrate the auto-detection:
        initHighlighting.called = false;
        (['DOMContentLoaded', 'load']).forEach(
          evt => window.addEventListener(evt, initHighlighting, false)
        );

        function initHighlighting() {
          if (initHighlighting.called)
            return;
          initHighlighting.called = true;

          Array.from(document.querySelectorAll('pre code')).forEach(block => {
            block.className = "";
            hljs.highlightBlock(block);
            const ul = block.parentElement.previousElementSibling;
            console.log(block, block.result, block.second_best, ul);
            ul.appendChild(addResult(ul, block.result));
            if (block.second_best)
              ul.appendChild(addResult(ul, block.second_best));
          });
        }

        function addResult (elt, result) {
          const li = document.createElement('li');
          li.innerText = result.language + ' ' + result.re;
          return li;
        }
      }
    </script>
  </body>
</html>
